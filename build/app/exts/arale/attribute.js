define("app/exts/arale/attribute",function(){function t(t){return"[object String]"===j.call(t)}function r(t){return"[object Function]"===j.call(t)}function e(t){return null!=t&&t==t.window}function n(t){if(!t||"[object Object]"!==j.call(t)||t.nodeType||e(t))return!1;try{if(t.constructor&&!w.call(t,"constructor")&&!w.call(t.constructor.prototype,"isPrototypeOf"))return!1}catch(t){return!1}var r;if(O)for(r in t)return w.call(t,r);for(r in t);return void 0===r||w.call(t,r)}function i(t){if(!t||"[object Object]"!==j.call(t)||t.nodeType||e(t)||!t.hasOwnProperty)return!1;for(var r in t)if(t.hasOwnProperty(r))return!1;return!0}function a(t,r){var e;for(e in r)r.hasOwnProperty(e)&&(t[e]=o(r[e],t[e]));return t}function o(t,r){return A(t)?t=t.slice():n(t)&&(n(r)||(r={}),t=a(r,t)),t}function c(t,r,e){for(var n=[],a=r.constructor.prototype;a;)a.hasOwnProperty("attrs")||(a.attrs={}),s(e,a.attrs,a),i(a.attrs)||n.unshift(a.attrs),a=a.constructor.superclass;for(var o=0,c=n.length;o<c;o++)g(t,v(n[o]))}function u(t,r){g(t,v(r,!0),!0)}function s(t,r,e,n){for(var i=0,a=t.length;i<a;i++){var o=t[i];e.hasOwnProperty(o)&&(r[o]=n?r.get(o):e[o])}}function f(t,e){for(var n in e)if(e.hasOwnProperty(n)){var i,a=e[n].value;r(a)&&(i=n.match(_))&&(t[i[1]](l(i[2]),a),delete e[n])}}function l(t){var r=t.match(x),e=r[1]?"change:":"";return e+=r[2].toLowerCase()+r[3]}function h(t,r,e){var n={silent:!0};t.__initializingAttrs=!0;for(var i in e)e.hasOwnProperty(i)&&r[i].setter&&t.set(i,e[i],n);delete t.__initializingAttrs}function v(t,r){var e={};for(var i in t){var a=t[i];!r&&n(a)&&p(a,S)?e[i]=a:e[i]={value:a}}return e}function g(t,r,e){var n,i,a;for(n in r)if(r.hasOwnProperty(n)){if(i=r[n],a=t[n],a||(a=t[n]={}),void 0!==i.value&&(a.value=o(i.value,a.value)),e)continue;for(var c in m){var u=m[c];void 0!==i[u]&&(a[u]=i[u])}}return t}function p(t,r){for(var e=0,n=r.length;e<n;e++)if(t.hasOwnProperty(r[e]))return!0;return!1}function y(r){return null==r||(t(r)||A(r))&&0===r.length||i(r)}function b(t,r){if(t===r)return!0;if(y(t)&&y(r))return!0;var e=j.call(t);if(e!=j.call(r))return!1;switch(e){case"[object String]":return t==String(r);case"[object Number]":return t!=+t?r!=+r:0==t?1/t==1/r:t==+r;case"[object Date]":case"[object Boolean]":return+t==+r;case"[object RegExp]":return t.source==r.source&&t.global==r.global&&t.multiline==r.multiline&&t.ignoreCase==r.ignoreCase;case"[object Array]":var i=t.toString(),a=r.toString();return-1===i.indexOf("[object")&&-1===a.indexOf("[object")&&i===a}if("object"!=typeof t||"object"!=typeof r)return!1;if(n(t)&&n(r)){if(!b(P(t),P(r)))return!1;for(var o in t)if(t[o]!==r[o])return!1;return!0}return!1}var O,d={initAttrs:function(t){var r=this.attrs={},e=this.propsInAttrs||[];c(r,this,e),t&&u(r,t),h(this,r,t),f(this,r),s(e,this,r,!0)},get:function(t){var r=this.attrs[t]||{},e=r.value;return r.getter?r.getter.call(this,e,t):e},set:function(r,e,i){var o={};t(r)?o[r]=e:(o=r,i=e),i||(i={});var c=i.silent,u=i.override,s=this.attrs,f=this.__changedAttrs||(this.__changedAttrs={});for(r in o)if(o.hasOwnProperty(r)){var l=s[r]||(s[r]={});if(e=o[r],l.readOnly)throw new Error("This attribute is readOnly: "+r);l.setter&&(e=l.setter.call(this,e,r));var h=this.get(r);!u&&n(h)&&n(e)&&(e=a(a({},h),e)),s[r].value=e,this.__initializingAttrs||b(h,e)||(c?f[r]=[e,h]:this.trigger("change:"+r,e,h,r))}return this},change:function(){var t=this.__changedAttrs;if(t){for(var r in t)if(t.hasOwnProperty(r)){var e=t[r];this.trigger("change:"+r,e[0],e[1],r)}delete this.__changedAttrs}return this},_isPlainObject:n},j=Object.prototype.toString,w=Object.prototype.hasOwnProperty;!function(){function t(){this.x=1}var r=[];t.prototype={valueOf:1,y:1};for(var e in new t)r.push(e);O="x"!==r[0]}();var A=Array.isArray||function(t){return"[object Array]"===j.call(t)},P=Object.keys;P||(P=function(t){var r=[];for(var e in t)t.hasOwnProperty(e)&&r.push(e);return r});var _=/^(on|before|after)([A-Z].*)$/,x=/^(Change)?([A-Z])(.*)/,S=["value","getter","setter","readOnly"],m=["setter","getter","readOnly"];return d});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImV4dHMvYXJhbGUvYXR0cmlidXRlLmpzIl0sIm5hbWVzIjpbImRlZmluZSIsImlzU3RyaW5nIiwidmFsIiwidG9TdHJpbmciLCJjYWxsIiwiaXNGdW5jdGlvbiIsImlzV2luZG93IiwibyIsIndpbmRvdyIsImlzUGxhaW5PYmplY3QiLCJub2RlVHlwZSIsImNvbnN0cnVjdG9yIiwiaGFzT3duIiwicHJvdG90eXBlIiwiZSIsImtleSIsIml0ZXJhdGVzT3duTGFzdCIsInVuZGVmaW5lZCIsImlzRW1wdHlPYmplY3QiLCJoYXNPd25Qcm9wZXJ0eSIsInAiLCJtZXJnZSIsInJlY2VpdmVyIiwic3VwcGxpZXIiLCJjbG9uZVZhbHVlIiwidmFsdWUiLCJwcmV2IiwiaXNBcnJheSIsInNsaWNlIiwibWVyZ2VJbmhlcml0ZWRBdHRycyIsImF0dHJzIiwiaW5zdGFuY2UiLCJzcGVjaWFsUHJvcHMiLCJpbmhlcml0ZWQiLCJwcm90byIsImNvcHlTcGVjaWFsUHJvcHMiLCJ1bnNoaWZ0Iiwic3VwZXJjbGFzcyIsImkiLCJsZW4iLCJsZW5ndGgiLCJtZXJnZUF0dHJzIiwibm9ybWFsaXplIiwibWVyZ2VVc2VyVmFsdWUiLCJjb25maWciLCJpc0F0dHIyUHJvcCIsImdldCIsInBhcnNlRXZlbnRzRnJvbUF0dHJzIiwiaG9zdCIsIm0iLCJtYXRjaCIsIkVWRU5UX1BBVFRFUk4iLCJnZXRFdmVudE5hbWUiLCJuYW1lIiwiRVZFTlRfTkFNRV9QQVRURVJOIiwicmV0IiwidG9Mb3dlckNhc2UiLCJzZXRTZXR0ZXJBdHRycyIsIm9wdGlvbnMiLCJzaWxlbnQiLCJfX2luaXRpYWxpemluZ0F0dHJzIiwic2V0dGVyIiwic2V0IiwiaXNVc2VyVmFsdWUiLCJuZXdBdHRycyIsImF0dHIiLCJoYXNPd25Qcm9wZXJ0aWVzIiwiQVRUUl9TUEVDSUFMX0tFWVMiLCJpbmhlcml0ZWRBdHRycyIsIkFUVFJfT1BUSU9OUyIsIm9wdGlvbiIsIm9iamVjdCIsInByb3BlcnRpZXMiLCJpc0VtcHR5QXR0clZhbHVlIiwiaXNFcXVhbCIsImEiLCJiIiwiY2xhc3NOYW1lIiwiU3RyaW5nIiwic291cmNlIiwiZ2xvYmFsIiwibXVsdGlsaW5lIiwiaWdub3JlQ2FzZSIsImFTdHJpbmciLCJiU3RyaW5nIiwiaW5kZXhPZiIsImtleXMiLCJleHBvcnRzIiwiaW5pdEF0dHJzIiwidGhpcyIsInByb3BzSW5BdHRycyIsImdldHRlciIsIm92ZXJyaWRlIiwibm93IiwiY2hhbmdlZCIsIl9fY2hhbmdlZEF0dHJzIiwicmVhZE9ubHkiLCJFcnJvciIsInRyaWdnZXIiLCJjaGFuZ2UiLCJhcmdzIiwiX2lzUGxhaW5PYmplY3QiLCJPYmplY3QiLCJDdG9yIiwieCIsInByb3BzIiwidmFsdWVPZiIsInkiLCJwcm9wIiwicHVzaCIsIkFycmF5IiwicmVzdWx0Il0sIm1hcHBpbmdzIjoiQUFBQUEsT0FBTywyQkFBNEIsV0E0SmpDLFFBQVNDLEdBQVNDLEdBQ2hCLE1BQThCLG9CQUF2QkMsRUFBU0MsS0FBS0YsR0FHdkIsUUFBU0csR0FBV0gsR0FDbEIsTUFBOEIsc0JBQXZCQyxFQUFTQyxLQUFLRixHQUd2QixRQUFTSSxHQUFTQyxHQUNoQixNQUFZLE9BQUxBLEdBQWFBLEdBQUtBLEVBQUVDLE9BRzdCLFFBQVNDLEdBQWNGLEdBS3JCLElBQUtBLEdBQTBCLG9CQUFyQkosRUFBU0MsS0FBS0csSUFDcEJBLEVBQUVHLFVBQVlKLEVBQVNDLEdBQ3pCLE9BQU8sQ0FHVCxLQUVFLEdBQUlBLEVBQUVJLGNBQ0RDLEVBQU9SLEtBQUtHLEVBQUcsaUJBQ2ZLLEVBQU9SLEtBQUtHLEVBQUVJLFlBQVlFLFVBQVcsaUJBQ3hDLE9BQU8sRUFFVCxNQUFPQyxHQUVQLE9BQU8sRUFHVCxHQUFJQyxFQUtKLElBQUlDLEVBQ0YsSUFBS0QsSUFBT1IsR0FDVixNQUFPSyxHQUFPUixLQUFLRyxFQUFHUSxFQU0xQixLQUFLQSxJQUFPUixJQUVaLFdBQWVVLEtBQVJGLEdBQXFCSCxFQUFPUixLQUFLRyxFQUFHUSxHQUc3QyxRQUFTRyxHQUFjWCxH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R0FBSUMsS0FBUSxJQUFJTCxHQUFVRSxFQUFNSSxLQUFLRCxFQUMxQzVGLEdBQStCLE1BQWJ5RixFQUFNLEtBRzFCLElBQUk5RSxHQUFVbUYsTUFBTW5GLFNBQVcsU0FBU3pCLEdBQ3RDLE1BQThCLG1CQUF2QkMsRUFBU0MsS0FBS0YsSUE2Rm5Cb0YsRUFBT2dCLE9BQU9oQixJQUViQSxLQUNIQSxFQUFPLFNBQVMvRSxHQUNkLEdBQUl3RyxLQUVKLEtBQUssR0FBSTFELEtBQVE5QyxHQUNYQSxFQUFFWSxlQUFla0MsSUFDbkIwRCxFQUFPRixLQUFLeEQsRUFHaEIsT0FBTzBELElBK0NYLElBQUk1RCxHQUFnQiwrQkFDaEJHLEVBQXFCLHdCQXdDckJhLEdBQXFCLFFBQVMsU0FBVSxTQUFVLFlBZ0NsREUsR0FBZ0IsU0FBVSxTQUFVLFdBNkh4QyxPQUFPa0IiLCJmaWxlIjoiZXh0cy9hcmFsZS9hdHRyaWJ1dGUuanMiLCJzb3VyY2VzQ29udGVudCI6WyJkZWZpbmUoJ2FwcC9leHRzL2FyYWxlL2F0dHJpYnV0ZScsIGZ1bmN0aW9uICgpIHtcblxuICAvLyBBdHRyaWJ1dGVcbiAgLy8gLS0tLS0tLS0tLS0tLS0tLS1cbiAgLy8gVGhhbmtzIHRvOlxuICAvLyAgLSBodHRwOi8vZG9jdW1lbnRjbG91ZC5naXRodWIuY29tL2JhY2tib25lLyNNb2RlbFxuICAvLyAgLSBodHRwOi8veXVpbGlicmFyeS5jb20veXVpL2RvY3MvYXBpL2NsYXNzZXMvQXR0cmlidXRlQ29yZS5odG1sXG4gIC8vICAtIGh0dHBzOi8vZ2l0aHViLmNvbS9iZXJ6bml6L2JhY2tib25lLmdldHRlcnMuc2V0dGVyc1xuXG5cbiAgLy8g6LSf6LSjIGF0dHJpYnV0ZXMg55qE5Yid5aeL5YyWXG4gIC8vIGF0dHJpYnV0ZXMg5piv5LiO5a6e5L6L55u45YWz55qE54q25oCB5L+h5oGv77yM5Y+v6K+75Y+v5YaZ77yM5Y+R55Sf5Y+Y5YyW5pe277yM5Lya6Ieq5Yqo6Kem5Y+R55u45YWz5LqL5Lu2XG4gIHZhciBleHBvcnRzID0ge1xuICAgIGluaXRBdHRyczogZnVuY3Rpb24oY29uZmlnKSB7XG4gICAgICAvLyBpbml0QXR0cnMg5piv5Zyo5Yid5aeL5YyW5pe26LCD55So55qE77yM6buY6K6k5oOF5Ya15LiL5a6e5L6L5LiK6IKv5a6a5rKh5pyJIGF0dHJz77yM5LiN5a2Y5Zyo6KaG55uW6Zeu6aKYXG4gICAgICB2YXIgYXR0cnMgPSB0aGlzLmF0dHJzID0ge307XG5cbiAgICAgIC8vIEdldCBhbGwgaW5oZXJpdGVkIGF0dHJpYnV0ZXMuXG4gICAgICB2YXIgc3BlY2lhbFByb3BzID0gdGhpcy5wcm9wc0luQXR0cnMgfHwgW107XG4gICAgICBtZXJnZUluaGVyaXRlZEF0dHJzKGF0dHJzLCB0aGlzLCBzcGVjaWFsUHJvcHMpO1xuXG4gICAgICAvLyBNZXJnZSB1c2VyLXNwZWNpZmljIGF0dHJpYnV0ZXMgZnJvbSBjb25maWcuXG4gICAgICBpZiAoY29uZmlnKSB7XG4gICAgICAgIG1lcmdlVXNlclZhbHVlKGF0dHJzLCBjb25maWcpO1xuICAgICAgfVxuXG4gICAgICAvLyDlr7nkuo7mnIkgc2V0dGVyIOeahOWxnuaAp++8jOimgeeUqOWIneWni+WAvCBzZXQg5LiA5LiL77yM5Lul5L+d6K+B5YWz6IGU5bGe5oCn5Lmf5LiA5ZCM5Yid5aeL5YyWXG4gICAgICBzZXRTZXR0ZXJBdHRycyh0aGlzLCBhdHRycywgY29uZmlnKTtcblxuICAgICAgLy8gQ29udmVydCBgb24vYmVmb3JlL2FmdGVyWHh4YCBjb25maWcgdG8gZXZlbnQgaGFuZGxlci5cbiAgICAgIHBhcnNlRXZlbnRzRnJvbUF0dHJzKHRoaXMsIGF0dHJzKTtcblxuICAgICAgLy8g5bCGIHRoaXMuYXR0cnMg5LiK55qEIHNwZWNpYWwgcHJvcGVydGllcyDmlL7lm54gdGhpcyDkuIpcbiAgICAgIGNvcHlTcGVjaWFsUHJvcHMoc3BlY2lhbFByb3BzLCB0aGlzLCBhdHRycywgdHJ1ZSk7XG4gICAgfSxcblxuICAgIC8vIEdldCB0aGUgdmFsdWUgb2YgYW4gYXR0cmlidXRlLlxuICAgIGdldDogZnVuY3Rpb24oa2V5KSB7XG4gICAgICB2YXIgYXR0ciA9IHRoaXMuYXR0cnNba2V5XSB8fCB7fTtcbiAgICAgIHZhciB2YWwgPSBhdHRyLnZhbHVlO1xuICAgICAgcmV0dXJuIGF0dHIuZ2V0dGVyID8gYXR0ci5nZXR0ZXIuY2FsbCh0aGlzLCB2YWwsIGtleSkgOiB2YWw7XG4gICAgfSxcblxuICAgIC8vIFNldCBhIGhhc2ggb2YgbW9kZWwgYXR0cmlidXRlcyBvbiB0aGUgb2JqZWN0LCBmaXJpbmcgYFwiY2hhbmdlXCJgIHVubGVzc1xuICAgIC8vIHlvdSBjaG9vc2UgdG8gc2lsZW5jZSBpdC5cbiAgICBzZXQ6IGZ1bmN0aW9uKGtleSwgdmFsLCBvcHRpb25zKSB7XG4gICAgICB2YXIgYXR0cnMgPSB7fTtcblxuICAgICAgLy8gc2V0KFwia2V5XCIsIHZhbCwgb3B0aW9ucylcbiAgICAgIGlmIChpc1N0cmluZyhrZXkpKSB7XG4gICAgICAgIGF0dHJzW2tleV0gPSB2YWw7XG4gICAgICB9XG4gICAgICAvLyBzZXQoeyBcImtleVwiOiB2YWwsIFwia2V5MlwiOiB2YWwyIH0sIG9wdGlvbnMpXG4gICAgICBlbHNlIHtcbiAgICAgICAgYXR0cnMgPSBrZXk7XG4gICAgICAgIG9wdGlvbnMgPSB2YWw7XG4gICAgICB9XG5cbiAgICAgIG9wdGlvbnMgfHwgKG9wdGlvbnMgPSB7fSk7XG4gICAgICB2YXIgc2lsZW50ID0gb3B0aW9ucy5zaWxlbnQ7XG4gICAgICB2YXIgb3ZlcnJpZGUgPSBvcHRpb25zLm92ZXJyaWRlO1xuXG4gICAgICB2YXIgbm93ID0gdGhpcy5hdHRycztcbiAgICAgIHZhciBjaGFuZ2VkID0gdGhpcy5fX2NoYW5nZWRBdHRycyB8fCAodGhpcy5fX2NoYW5nZWRBdHRycyA9IHt9KTtcblxuICAgICAgZm9yIChrZXkgaW4gYXR0cnMpIHtcbiAgICAgICAgaWYgKCFhdHRycy5oYXNPd25Qcm9wZXJ0eShrZXkpKSBjb250aW51ZTtcblxuICAgICAgICB2YXIgYXR0ciA9IG5vd1trZXldIHx8IChub3dba2V5XSA9IHt9KTtcbiAgICAgICAgdmFsID0gYXR0cnNba2V5XTtcblxuICAgICAgICBpZiAoYXR0ci5yZWFkT25seSkge1xuICAgICAgICAgIHRocm93IG5ldyBFcnJvcignVGhpcyBhdHRyaWJ1dGUgaXMgcmVhZE9ubHk6ICcgKyBrZXkpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gaW52b2tlIHNldHRlclxuICAgICAgICBpZiAoYXR0ci5zZXR0ZXIpIHtcbiAgICAgICAgICB2YWwgPSBhdHRyLnNldHRlci5jYWxsKHRoaXMsIHZhbCwga2V5KTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIOiOt+WPluiuvue9ruWJjeeahCBwcmV2IOWAvFxuICAgICAgICB2YXIgcHJldiA9IHRoaXMuZ2V0KGtleSk7XG5cbiAgICAgICAgLy8g6I635Y+W6ZyA6KaB6K6+572u55qEIHZhbCDlgLxcbiAgICAgICAgLy8g5aaC5p6c6K6+572u5LqGIG92ZXJyaWRlIOS4uiB0cnVl77yM6KGo56S66KaB5by65Yi26KaG55uW77yM5bCx5LiN5Y67IG1lcmdlIOS6hlxuICAgICAgICAvLyDpg73kuLrlr7nosaHml7bvvIzlgZogbWVyZ2Ug5pON5L2c77yM5Lul5L+d55WZIHByZXYg5LiK5rKh5pyJ6KaG55uW55qE5YC8XG4gICAgICAgIGlmICghb3ZlcnJpZGUgJiYgaXNQbGFpbk9iamVjdChwcmV2KSAmJiBpc1BsYWluT2JqZWN0KHZhbCkpIHtcbiAgICAgICAgICB2YWwgPSBtZXJnZShtZXJnZSh7fSwgcHJldiksIHZhbCk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBzZXQgZmluYWxseVxuICAgICAgICBub3dba2V5XS52YWx1ZSA9IHZhbDtcblxuICAgICAgICAvLyBpbnZva2UgY2hhbmdlIGV2ZW50XG4gICAgICAgIC8vIOWIneWni+WMluaXtuWvuSBzZXQg55qE6LCD55So77yM5LiN6Kem5Y+R5Lu75L2V5LqL5Lu2XG4gICAgICAgIGlmICghdGhpcy5fX2luaXRpYWxpemluZ0F0dHJzICYmICFpc0VxdWFsKHByZXYsIHZhbCkpIHtcbiAgICAgICAgICBpZiAoc2lsZW50KSB7XG4gICAgICAgICAgICBjaGFuZ2VkW2tleV0gPSBbdmFsLCBwcmV2XTtcbiAgICAgICAgICB9XG4gICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0aGlzLnRyaWdnZXIoJ2NoYW5nZTonICsga2V5LCB2YWwsIHByZXYsIGtleSk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIHJldHVybiB0aGlzO1xuICAgIH0sXG5cbiAgICAvLyBDYWxsIHRoaXMgbWV0aG9kIHRvIG1hbnVhbGx5IGZpcmUgYSBgXCJjaGFuZ2VcImAgZXZlbnQgZm9yIHRyaWdnZXJpbmdcbiAgICAvLyBhIGBcImNoYW5nZTphdHRyaWJ1dGVcImAgZXZlbnQgZm9yIGVhY2ggY2hhbmdlZCBhdHRyaWJ1dGUuXG4gICAgY2hhbmdlOiBmdW5jdGlvbigpIHtcbiAgICAgIHZhciBjaGFuZ2VkID0gdGhpcy5fX2NoYW5nZWRBdHRycztcblxuICAgICAgaWYgKGNoYW5nZWQpIHtcbiAgICAgICAgZm9yICh2YXIga2V5IGluIGNoYW5nZWQpIHtcbiAgICAgICAgICBpZiAoY2hhbmdlZC5oYXNPd25Qcm9wZXJ0eShrZXkpKSB7XG4gICAgICAgICAgICB2YXIgYXJncyA9IGNoYW5nZWRba2V5XTtcbiAgICAgICAgICAgIHRoaXMudHJpZ2dlcignY2hhbmdlOicgKyBrZXksIGFyZ3NbMF0sIGFyZ3NbMV0sIGtleSk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGRlbGV0ZSB0aGlzLl9fY2hhbmdlZEF0dHJzO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gdGhpcztcbiAgICB9LFxuXG4gICAgLy8gZm9yIHRlc3RcbiAgICBfaXNQbGFpbk9iamVjdDogaXNQbGFpbk9iamVjdFxuICB9XG5cbiAgLy8gSGVscGVyc1xuICAvLyAtLS0tLS0tXG5cbiAgdmFyIHRvU3RyaW5nID0gT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZztcbiAgdmFyIGhhc093biA9IE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHk7XG5cbiAgLyoqXG4gICAqIERldGVjdCB0aGUgSlNjcmlwdCBbW0RvbnRFbnVtXV0gYnVnOlxuICAgKiBJbiBJRSA8IDkgYW4gb2JqZWN0cyBvd24gcHJvcGVydGllcywgc2hhZG93aW5nIG5vbi1lbnVtZXJhYmxlIG9uZXMsIGFyZVxuICAgKiBtYWRlIG5vbi1lbnVtZXJhYmxlIGFzIHdlbGwuXG4gICAqIGh0dHBzOi8vZ2l0aHViLmNvbS9iZXN0aWVqcy9sb2Rhc2gvYmxvYi83NTIwMDY2ZmM5MTZlMjA1ZWY4NGNiOTdmYmZlNjMwZDdjMTU0MTU4L2xvZGFzaC5qcyNMMTM0LUwxNDRcbiAgICovXG4gIC8qKiBEZXRlY3QgaWYgb3duIHByb3BlcnRpZXMgYXJlIGl0ZXJhdGVkIGFmdGVyIGluaGVyaXRlZCBwcm9wZXJ0aWVzIChJRSA8IDkpICovXG4gIHZhciBpdGVyYXRlc093bkxhc3Q7XG4gIChmdW5jdGlvbigpIHtcbiAgICB2YXIgcHJvcHMgPSBbXTtcbiAgICBmdW5jdGlvbiBDdG9yKCkgeyB0aGlzLnggPSAxOyB9XG4gICAgQ3Rvci5wcm90b3R5cGUgPSB7ICd2YWx1ZU9mJzogMSwgJ3knOiAxIH07XG4gICAgZm9yICh2YXIgcHJvcCBpbiBuZXcgQ3RvcigpKSB7IHByb3BzLnB1c2gocHJvcCk7IH1cbiAgICBpdGVyYXRlc093bkxhc3QgPSBwcm9wc1swXSAhPT0gJ3gnO1xuICB9KCkpO1xuXG4gIHZhciBpc0FycmF5ID0gQXJyYXkuaXNBcnJheSB8fCBmdW5jdGlvbih2YWwpIHtcbiAgICByZXR1cm4gdG9TdHJpbmcuY2FsbCh2YWwpID09PSAnW29iamVjdCBBcnJheV0nO1xuICB9O1xuXG4gIGZ1bmN0aW9uIGlzU3RyaW5nKHZhbCkge1xuICAgIHJldHVybiB0b1N0cmluZy5jYWxsKHZhbCkgPT09ICdbb2JqZWN0IFN0cmluZ10nO1xuICB9XG5cbiAgZnVuY3Rpb24gaXNGdW5jdGlvbih2YWwpIHtcbiAgICByZXR1cm4gdG9TdHJpbmcuY2FsbCh2YWwpID09PSAnW29iamVjdCBGdW5jdGlvbl0nO1xuICB9XG5cbiAgZnVuY3Rpb24gaXNXaW5kb3cobykge1xuICAgIHJldHVybiBvICE9IG51bGwgJiYgbyA9PSBvLndpbmRvdztcbiAgfVxuXG4gIGZ1bmN0aW9uIGlzUGxhaW5PYmplY3Qobykge1xuICAgIC8vIE11c3QgYmUgYW4gT2JqZWN0LlxuICAgIC8vIEJlY2F1c2Ugb2YgSUUsIHdlIGFsc28gaGF2ZSB0byBjaGVjayB0aGUgcHJlc2VuY2Ugb2YgdGhlIGNvbnN0cnVjdG9yXG4gICAgLy8gcHJvcGVydHkuIE1ha2Ugc3VyZSB0aGF0IERPTSBub2RlcyBhbmQgd2luZG93IG9iamVjdHMgZG9uJ3RcbiAgICAvLyBwYXNzIHRocm91Z2gsIGFzIHdlbGxcbiAgICBpZiAoIW8gfHwgdG9TdHJpbmcuY2FsbChvKSAhPT0gXCJbb2JqZWN0IE9iamVjdF1cIiB8fFxuICAgICAgICBvLm5vZGVUeXBlIHx8IGlzV2luZG93KG8pKSB7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuXG4gICAgdHJ5IHtcbiAgICAgIC8vIE5vdCBvd24gY29uc3RydWN0b3IgcHJvcGVydHkgbXVzdCBiZSBPYmplY3RcbiAgICAgIGlmIChvLmNvbnN0cnVjdG9yICYmXG4gICAgICAgICAgIWhhc093bi5jYWxsKG8sIFwiY29uc3RydWN0b3JcIikgJiZcbiAgICAgICAgICAhaGFzT3duLmNhbGwoby5jb25zdHJ1Y3Rvci5wcm90b3R5cGUsIFwiaXNQcm90b3R5cGVPZlwiKSkge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICB9XG4gICAgfSBjYXRjaCAoZSkge1xuICAgICAgLy8gSUU4LDkgV2lsbCB0aHJvdyBleGNlcHRpb25zIG9uIGNlcnRhaW4gaG9zdCBvYmplY3RzICM5ODk3XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuXG4gICAgdmFyIGtleTtcblxuICAgIC8vIFN1cHBvcnQ6IElFPDlcbiAgICAvLyBIYW5kbGUgaXRlcmF0aW9uIG92ZXIgaW5oZXJpdGVkIHByb3BlcnRpZXMgYmVmb3JlIG93biBwcm9wZXJ0aWVzLlxuICAgIC8vIGh0dHA6Ly9idWdzLmpxdWVyeS5jb20vdGlja2V0LzEyMTk5XG4gICAgaWYgKGl0ZXJhdGVzT3duTGFzdCkge1xuICAgICAgZm9yIChrZXkgaW4gbykge1xuICAgICAgICByZXR1cm4gaGFzT3duLmNhbGwobywga2V5KTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBPd24gcHJvcGVydGllcyBhcmUgZW51bWVyYXRlZCBmaXJzdGx5LCBzbyB0byBzcGVlZCB1cCxcbiAgICAvLyBpZiBsYXN0IG9uZSBpcyBvd24sIHRoZW4gYWxsIHByb3BlcnRpZXMgYXJlIG93bi5cbiAgICBmb3IgKGtleSBpbiBvKSB7fVxuXG4gICAgcmV0dXJuIGtleSA9PT0gdW5kZWZpbmVkIHx8IGhhc093bi5jYWxsKG8sIGtleSk7XG4gIH1cblxuICBmdW5jdGlvbiBpc0VtcHR5T2JqZWN0KG8pIHtcbiAgICBpZiAoIW8gfHwgdG9TdHJpbmcuY2FsbChvKSAhPT0gXCJbb2JqZWN0IE9iamVjdF1cIiB8fFxuICAgICAgICBvLm5vZGVUeXBlIHx8IGlzV2luZG93KG8pIHx8ICFvLmhhc093blByb3BlcnR5KSB7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuXG4gICAgZm9yICh2YXIgcCBpbiBvKSB7XG4gICAgICBpZiAoby5oYXNPd25Qcm9wZXJ0eShwKSkgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICByZXR1cm4gdHJ1ZTtcbiAgfVxuXG4gIGZ1bmN0aW9uIG1lcmdlKHJlY2VpdmVyLCBzdXBwbGllcikge1xuICAgIHZhciBrZXksIHZhbHVlO1xuXG4gICAgZm9yIChrZXkgaW4gc3VwcGxpZXIpIHtcbiAgICAgIGlmIChzdXBwbGllci5oYXNPd25Qcm9wZXJ0eShrZXkpKSB7XG4gICAgICAgIHJlY2VpdmVyW2tleV0gPSBjbG9uZVZhbHVlKHN1cHBsaWVyW2tleV0sIHJlY2VpdmVyW2tleV0pO1xuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiByZWNlaXZlcjtcbiAgfVxuXG4gIC8vIOWPqiBjbG9uZSDmlbDnu4TlkowgcGxhaW4gb2JqZWN077yM5YW25LuW55qE5L+d5oyB5LiN5Y+YXG4gIGZ1bmN0aW9uIGNsb25lVmFsdWUodmFsdWUsIHByZXYpe1xuICAgIGlmIChpc0FycmF5KHZhbHVlKSkge1xuICAgICAgdmFsdWUgPSB2YWx1ZS5zbGljZSgpO1xuICAgIH1cbiAgICBlbHNlIGlmIChpc1BsYWluT2JqZWN0KHZhbHVlKSkge1xuICAgICAgaXNQbGFpbk9iamVjdChwcmV2KSB8fCAocHJldiA9IHt9KTtcblxuICAgICAgdmFsdWUgPSBtZXJnZShwcmV2LCB2YWx1ZSk7XG4gICAgfVxuXG4gICAgcmV0dXJuIHZhbHVlO1xuICB9XG5cbiAgdmFyIGtleXMgPSBPYmplY3Qua2V5cztcblxuICBpZiAoIWtleXMpIHtcbiAgICBrZXlzID0gZnVuY3Rpb24obykge1xuICAgICAgdmFyIHJlc3VsdCA9IFtdO1xuXG4gICAgICBmb3IgKHZhciBuYW1lIGluIG8pIHtcbiAgICAgICAgaWYgKG8uaGFzT3duUHJvcGVydHkobmFtZSkpIHtcbiAgICAgICAgICByZXN1bHQucHVzaChuYW1lKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9O1xuICB9XG5cbiAgZnVuY3Rpb24gbWVyZ2VJbmhlcml0ZWRBdHRycyhhdHRycywgaW5zdGFuY2UsIHNwZWNpYWxQcm9wcykge1xuICAgIHZhciBpbmhlcml0ZWQgPSBbXTtcbiAgICB2YXIgcHJvdG8gPSBpbnN0YW5jZS5jb25zdHJ1Y3Rvci5wcm90b3R5cGU7XG5cbiAgICB3aGlsZSAocHJvdG8pIHtcbiAgICAgIC8vIOS4jeimgeaLv+WIsCBwcm90b3R5cGUg5LiK55qEXG4gICAgICBpZiAoIXByb3RvLmhhc093blByb3BlcnR5KCdhdHRycycpKSB7XG4gICAgICAgIHByb3RvLmF0dHJzID0ge307XG4gICAgICB9XG5cbiAgICAgIC8vIOWwhiBwcm90byDkuIrnmoTnibnmroogcHJvcGVydGllcyDmlL7liLAgcHJvdG8uYXR0cnMg5LiK77yM5Lul5L6/5ZCI5bm2XG4gICAgICBjb3B5U3BlY2lhbFByb3BzKHNwZWNpYWxQcm9wcywgcHJvdG8uYXR0cnMsIHByb3RvKTtcblxuICAgICAgLy8g5Li656m65pe25LiN5re75YqgXG4gICAgICBpZiAoIWlzRW1wdHlPYmplY3QocHJvdG8uYXR0cnMpKSB7XG4gICAgICAgIGluaGVyaXRlZC51bnNoaWZ0KHByb3RvLmF0dHJzKTtcbiAgICAgIH1cblxuICAgICAgLy8g5ZCR5LiK5Zue5rqv5LiA57qnXG4gICAgICBwcm90byA9IHByb3RvLmNvbnN0cnVjdG9yLnN1cGVyY2xhc3M7XG4gICAgfVxuXG4gICAgLy8gTWVyZ2UgYW5kIGNsb25lIGRlZmF1bHQgdmFsdWVzIHRvIGluc3RhbmNlLlxuICAgIGZvciAodmFyIGkgPSAwLCBsZW4gPSBpbmhlcml0ZWQubGVuZ3RoOyBpIDwgbGVuOyBpKyspIHtcbiAgICAgIG1lcmdlQXR0cnMoYXR0cnMsIG5vcm1hbGl6ZShpbmhlcml0ZWRbaV0pKTtcbiAgICB9XG4gIH1cblxuICBmdW5jdGlvbiBtZXJnZVVzZXJWYWx1ZShhdHRycywgY29uZmlnKSB7XG4gICAgbWVyZ2VBdHRycyhhdHRycywgbm9ybWFsaXplKGNvbmZpZywgdHJ1ZSksIHRydWUpO1xuICB9XG5cbiAgZnVuY3Rpb24gY29weVNwZWNpYWxQcm9wcyhzcGVjaWFsUHJvcHMsIHJlY2VpdmVyLCBzdXBwbGllciwgaXNBdHRyMlByb3ApIHtcbiAgICBmb3IgKHZhciBpID0gMCwgbGVuID0gc3BlY2lhbFByb3BzLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7XG4gICAgICB2YXIga2V5ID0gc3BlY2lhbFByb3BzW2ldO1xuXG4gICAgICBpZiAoc3VwcGxpZXIuaGFzT3duUHJvcGVydHkoa2V5KSkge1xuICAgICAgICByZWNlaXZlcltrZXldID0gaXNBdHRyMlByb3AgPyByZWNlaXZlci5nZXQoa2V5KSA6IHN1cHBsaWVyW2tleV07XG4gICAgICB9XG4gICAgfVxuICB9XG5cblxuICB2YXIgRVZFTlRfUEFUVEVSTiA9IC9eKG9ufGJlZm9yZXxhZnRlcikoW0EtWl0uKikkLztcbiAgdmFyIEVWRU5UX05BTUVfUEFUVEVSTiA9IC9eKENoYW5nZSk/KFtBLVpdKSguKikvO1xuXG4gIGZ1bmN0aW9uIHBhcnNlRXZlbnRzRnJvbUF0dHJzKGhvc3QsIGF0dHJzKSB7XG4gICAgZm9yICh2YXIga2V5IGluIGF0dHJzKSB7XG4gICAgICBpZiAoYXR0cnMuaGFzT3duUHJvcGVydHkoa2V5KSkge1xuICAgICAgICB2YXIgdmFsdWUgPSBhdHRyc1trZXldLnZhbHVlLCBtO1xuXG4gICAgICAgIGlmIChpc0Z1bmN0aW9uKHZhbHVlKSAmJiAobSA9IGtleS5tYXRjaChFVkVOVF9QQVRURVJOKSkpIHtcbiAgICAgICAgICBob3N0W21bMV1dKGdldEV2ZW50TmFtZShtWzJdKSwgdmFsdWUpO1xuICAgICAgICAgIGRlbGV0ZSBhdHRyc1trZXldO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgLy8gQ29udmVydHMgYFNob3dgIHRvIGBzaG93YCBhbmQgYENoYW5nZVRpdGxlYCB0byBgY2hhbmdlOnRpdGxlYFxuICBmdW5jdGlvbiBnZXRFdmVudE5hbWUobmFtZSkge1xuICAgIHZhciBtID0gbmFtZS5tYXRjaChFVkVOVF9OQU1FX1BBVFRFUk4pO1xuICAgIHZhciByZXQgPSBtWzFdID8gJ2NoYW5nZTonIDogJyc7XG4gICAgcmV0ICs9IG1bMl0udG9Mb3dlckNhc2UoKSArIG1bM107XG4gICAgcmV0dXJuIHJldDtcbiAgfVxuXG5cbiAgZnVuY3Rpb24gc2V0U2V0dGVyQXR0cnMoaG9zdCwgYXR0cnMsIGNvbmZpZykge1xuICAgIHZhciBvcHRpb25zID0geyBzaWxlbnQ6IHRydWUgfTtcbiAgICBob3N0Ll9faW5pdGlhbGl6aW5nQXR0cnMgPSB0cnVlO1xuXG4gICAgZm9yICh2YXIga2V5IGluIGNvbmZpZykge1xuICAgICAgaWYgKGNvbmZpZy5oYXNPd25Qcm9wZXJ0eShrZXkpKSB7XG4gICAgICAgIGlmIChhdHRyc1trZXldLnNldHRlcikge1xuICAgICAgICAgIGhvc3Quc2V0KGtleSwgY29uZmlnW2tleV0sIG9wdGlvbnMpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuXG4gICAgZGVsZXRlIGhvc3QuX19pbml0aWFsaXppbmdBdHRycztcbiAgfVxuXG5cbiAgdmFyIEFUVFJfU1BFQ0lBTF9LRVlTID0gWyd2YWx1ZScsICdnZXR0ZXInLCAnc2V0dGVyJywgJ3JlYWRPbmx5J107XG5cbiAgLy8gbm9ybWFsaXplIGBhdHRyc2AgdG9cbiAgLy9cbiAgLy8gICB7XG4gIC8vICAgICAgdmFsdWU6ICd4eCcsXG4gIC8vICAgICAgZ2V0dGVyOiBmbixcbiAgLy8gICAgICBzZXR0ZXI6IGZuLFxuICAvLyAgICAgIHJlYWRPbmx5OiBib29sZWFuXG4gIC8vICAgfVxuICAvL1xuICBmdW5jdGlvbiBub3JtYWxpemUoYXR0cnMsIGlzVXNlclZhbHVlKSB7XG4gICAgdmFyIG5ld0F0dHJzID0ge307XG5cbiAgICBmb3IgKHZhciBrZXkgaW4gYXR0cnMpIHtcbiAgICAgIHZhciBhdHRyID0gYXR0cnNba2V5XTtcblxuICAgICAgaWYgKCFpc1VzZXJWYWx1ZSAmJlxuICAgICAgICAgIGlzUGxhaW5PYmplY3QoYXR0cikgJiZcbiAgICAgICAgICBoYXNPd25Qcm9wZXJ0aWVzKGF0dHIsIEFUVFJfU1BFQ0lBTF9LRVlTKSkge1xuICAgICAgICBuZXdBdHRyc1trZXldID0gYXR0cjtcbiAgICAgICAgY29udGludWU7XG4gICAgICB9XG5cbiAgICAgIG5ld0F0dHJzW2tleV0gPSB7XG4gICAgICAgIHZhbHVlOiBhdHRyXG4gICAgICB9O1xuICAgIH1cblxuICAgIHJldHVybiBuZXdBdHRycztcbiAgfVxuXG4gIHZhciBBVFRSX09QVElPTlMgPSBbJ3NldHRlcicsICdnZXR0ZXInLCAncmVhZE9ubHknXTtcbiAgLy8g5LiT55So5LqOIGF0dHJzIOeahCBtZXJnZSDmlrnms5VcbiAgZnVuY3Rpb24gbWVyZ2VBdHRycyhhdHRycywgaW5oZXJpdGVkQXR0cnMsIGlzVXNlclZhbHVlKXtcbiAgICB2YXIga2V5LCB2YWx1ZTtcbiAgICB2YXIgYXR0cjtcblxuICAgIGZvciAoa2V5IGluIGluaGVyaXRlZEF0dHJzKSB7XG4gICAgICBpZiAoaW5oZXJpdGVkQXR0cnMuaGFzT3duUHJvcGVydHkoa2V5KSkge1xuICAgICAgICB2YWx1ZSA9IGluaGVyaXRlZEF0dHJzW2tleV07XG4gICAgICAgIGF0dHIgPSBhdHRyc1trZXldO1xuXG4gICAgICAgIGlmICghYXR0cikge1xuICAgICAgICAgIGF0dHIgPSBhdHRyc1trZXldID0ge307XG4gICAgICAgIH1cblxuICAgICAgICAvLyDku47kuKXosKjkuIrmnaXor7TvvIzpgY3ljoYgQVRUUl9TUEVDSUFMX0tFWVMg5pu05aW9XG4gICAgICAgIC8vIOS7juaAp+iDveadpeivtO+8jOebtOaOpSDkurrogonotYvlgLwg5pu05b+rXG4gICAgICAgIC8vIOi/memHjOi/mOaYr+mAieaLqSDmgKfog73kvJjlhYhcblxuICAgICAgICAvLyDlj6rmnIkgdmFsdWUg6KaB5aSN5Yi25Y6f5YC877yM5YW25LuW55qE55u05o6l6KaG55uW5Y2z5Y+vXG4gICAgICAgICh2YWx1ZVsndmFsdWUnXSAhPT0gdW5kZWZpbmVkKSAmJiAoYXR0clsndmFsdWUnXSA9IGNsb25lVmFsdWUodmFsdWVbJ3ZhbHVlJ10sIGF0dHJbJ3ZhbHVlJ10pKTtcblxuICAgICAgICAvLyDlpoLmnpzmmK/nlKjmiLfotYvlgLzvvIzlj6ropoHogIPomZF2YWx1ZVxuICAgICAgICBpZiAoaXNVc2VyVmFsdWUpIGNvbnRpbnVlO1xuXG4gICAgICAgIGZvciAodmFyIGkgaW4gQVRUUl9PUFRJT05TKSB7XG4gICAgICAgICAgdmFyIG9wdGlvbiA9IEFUVFJfT1BUSU9OU1tpXTtcbiAgICAgICAgICBpZiAodmFsdWVbb3B0aW9uXSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICBhdHRyW29wdGlvbl0gPSB2YWx1ZVtvcHRpb25dO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiBhdHRycztcbiAgfVxuXG4gIGZ1bmN0aW9uIGhhc093blByb3BlcnRpZXMob2JqZWN0LCBwcm9wZXJ0aWVzKSB7XG4gICAgZm9yICh2YXIgaSA9IDAsIGxlbiA9IHByb3BlcnRpZXMubGVuZ3RoOyBpIDwgbGVuOyBpKyspIHtcbiAgICAgIGlmIChvYmplY3QuaGFzT3duUHJvcGVydHkocHJvcGVydGllc1tpXSkpIHtcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiBmYWxzZTtcbiAgfVxuXG5cbiAgLy8g5a+55LqOIGF0dHJzIOeahCB2YWx1ZSDmnaXor7TvvIzku6XkuIvlgLzpg73orqTkuLrmmK/nqbrlgLzvvJogbnVsbCwgdW5kZWZpbmVkLCAnJywgW10sIHt9XG4gIGZ1bmN0aW9uIGlzRW1wdHlBdHRyVmFsdWUobykge1xuICAgIHJldHVybiBvID09IG51bGwgfHwgLy8gbnVsbCwgdW5kZWZpbmVkXG4gICAgICAgIChpc1N0cmluZyhvKSB8fCBpc0FycmF5KG8pKSAmJiBvLmxlbmd0aCA9PT0gMCB8fCAvLyAnJywgW11cbiAgICAgICAgaXNFbXB0eU9iamVjdChvKTsgLy8ge31cbiAgfVxuXG4gIC8vIOWIpOaWreWxnuaAp+WAvCBhIOWSjCBiIOaYr+WQpuebuOetie+8jOazqOaEj+S7hemAgueUqOS6juWxnuaAp+WAvOeahOWIpOaWre+8jOmdnuaZrumAgueahCA9PT0g5oiWID09IOWIpOaWreOAglxuICBmdW5jdGlvbiBpc0VxdWFsKGEsIGIpIHtcbiAgICBpZiAoYSA9PT0gYikgcmV0dXJuIHRydWU7XG5cbiAgICBpZiAoaXNFbXB0eUF0dHJWYWx1ZShhKSAmJiBpc0VtcHR5QXR0clZhbHVlKGIpKSByZXR1cm4gdHJ1ZTtcblxuICAgIC8vIENvbXBhcmUgYFtbQ2xhc3NdXWAgbmFtZXMuXG4gICAgdmFyIGNsYXNzTmFtZSA9IHRvU3RyaW5nLmNhbGwoYSk7XG4gICAgaWYgKGNsYXNzTmFtZSAhPSB0b1N0cmluZy5jYWxsKGIpKSByZXR1cm4gZmFsc2U7XG5cbiAgICBzd2l0Y2ggKGNsYXNzTmFtZSkge1xuXG4gICAgICAvLyBTdHJpbmdzLCBudW1iZXJzLCBkYXRlcywgYW5kIGJvb2xlYW5zIGFyZSBjb21wYXJlZCBieSB2YWx1ZS5cbiAgICAgIGNhc2UgJ1tvYmplY3QgU3RyaW5nXSc6XG4gICAgICAgIC8vIFByaW1pdGl2ZXMgYW5kIHRoZWlyIGNvcnJlc3BvbmRpbmcgb2JqZWN0IHdyYXBwZXJzIGFyZVxuICAgICAgICAvLyBlcXVpdmFsZW50OyB0aHVzLCBgXCI1XCJgIGlzIGVxdWl2YWxlbnQgdG8gYG5ldyBTdHJpbmcoXCI1XCIpYC5cbiAgICAgICAgcmV0dXJuIGEgPT0gU3RyaW5nKGIpO1xuXG4gICAgICBjYXNlICdbb2JqZWN0IE51bWJlcl0nOlxuICAgICAgICAvLyBgTmFOYHMgYXJlIGVxdWl2YWxlbnQsIGJ1dCBub24tcmVmbGV4aXZlLiBBbiBgZXF1YWxgXG4gICAgICAgIC8vIGNvbXBhcmlzb24gaXMgcGVyZm9ybWVkIGZvciBvdGhlciBudW1lcmljIHZhbHVlcy5cbiAgICAgICAgcmV0dXJuIGEgIT0gK2EgPyBiICE9ICtiIDogKGEgPT0gMCA/IDEgLyBhID09IDEgLyBiIDogYSA9PSArYik7XG5cbiAgICAgIGNhc2UgJ1tvYmplY3QgRGF0ZV0nOlxuICAgICAgY2FzZSAnW29iamVjdCBCb29sZWFuXSc6XG4gICAgICAgIC8vIENvZXJjZSBkYXRlcyBhbmQgYm9vbGVhbnMgdG8gbnVtZXJpYyBwcmltaXRpdmUgdmFsdWVzLlxuICAgICAgICAvLyBEYXRlcyBhcmUgY29tcGFyZWQgYnkgdGhlaXIgbWlsbGlzZWNvbmQgcmVwcmVzZW50YXRpb25zLlxuICAgICAgICAvLyBOb3RlIHRoYXQgaW52YWxpZCBkYXRlcyB3aXRoIG1pbGxpc2Vjb25kIHJlcHJlc2VudGF0aW9uc1xuICAgICAgICAvLyBvZiBgTmFOYCBhcmUgbm90IGVxdWl2YWxlbnQuXG4gICAgICAgIHJldHVybiArYSA9PSArYjtcblxuICAgICAgLy8gUmVnRXhwcyBhcmUgY29tcGFyZWQgYnkgdGhlaXIgc291cmNlIHBhdHRlcm5zIGFuZCBmbGFncy5cbiAgICAgIGNhc2UgJ1tvYmplY3QgUmVnRXhwXSc6XG4gICAgICAgIHJldHVybiBhLnNvdXJjZSA9PSBiLnNvdXJjZSAmJlxuICAgICAgICAgICAgYS5nbG9iYWwgPT0gYi5nbG9iYWwgJiZcbiAgICAgICAgICAgIGEubXVsdGlsaW5lID09IGIubXVsdGlsaW5lICYmXG4gICAgICAgICAgICBhLmlnbm9yZUNhc2UgPT0gYi5pZ25vcmVDYXNlO1xuXG4gICAgICAvLyDnroDljZXliKTmlq3mlbDnu4TljIXlkKvnmoQgcHJpbWl0aXZlIOWAvOaYr+WQpuebuOetiVxuICAgICAgY2FzZSAnW29iamVjdCBBcnJheV0nOlxuICAgICAgICB2YXIgYVN0cmluZyA9IGEudG9TdHJpbmcoKTtcbiAgICAgICAgdmFyIGJTdHJpbmcgPSBiLnRvU3RyaW5nKCk7XG5cbiAgICAgICAgLy8g5Y+q6KaB5YyF5ZCr6Z2eIHByaW1pdGl2ZSDlgLzvvIzkuLrkuobnqLPlpqXotbfop4HvvIzpg73ov5Tlm54gZmFsc2VcbiAgICAgICAgcmV0dXJuIGFTdHJpbmcuaW5kZXhPZignW29iamVjdCcpID09PSAtMSAmJlxuICAgICAgICAgICAgYlN0cmluZy5pbmRleE9mKCdbb2JqZWN0JykgPT09IC0xICYmXG4gICAgICAgICAgICBhU3RyaW5nID09PSBiU3RyaW5nO1xuICAgIH1cblxuICAgIGlmICh0eXBlb2YgYSAhPSAnb2JqZWN0JyB8fCB0eXBlb2YgYiAhPSAnb2JqZWN0JykgcmV0dXJuIGZhbHNlO1xuXG4gICAgLy8g566A5Y2V5Yik5pat5Lik5Liq5a+56LGh5piv5ZCm55u4562J77yM5Y+q5Yik5pat56ys5LiA5bGCXG4gICAgaWYgKGlzUGxhaW5PYmplY3QoYSkgJiYgaXNQbGFpbk9iamVjdChiKSkge1xuXG4gICAgICAvLyDplK7lgLzkuI3nm7jnrYnvvIznq4vliLvov5Tlm54gZmFsc2VcbiAgICAgIGlmICghaXNFcXVhbChrZXlzKGEpLCBrZXlzKGIpKSkge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICB9XG5cbiAgICAgIC8vIOmUruebuOWQjO+8jOS9huacieWAvOS4jeetie+8jOeri+WIu+i/lOWbniBmYWxzZVxuICAgICAgZm9yICh2YXIgcCBpbiBhKSB7XG4gICAgICAgIGlmIChhW3BdICE9PSBiW3BdKSByZXR1cm4gZmFsc2U7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cblxuICAgIC8vIOWFtuS7luaDheWGtei/lOWbniBmYWxzZSwg5Lul6YG/5YWN6K+v5Yik5a+86Ie0IGNoYW5nZSDkuovku7bmsqHlj5HnlJ9cbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cblxuICByZXR1cm4gZXhwb3J0c1xufSkiXX0=
